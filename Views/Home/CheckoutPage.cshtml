@model VPWebSolutions.Models.CheckoutModel
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager


@{
    ViewData["Title"] = "CheckoutPage";
}
@using VPWebSolutions.Logic;



<h1>Checkout Page</h1>
<hr />
<h2>Summary: </h2>
<div>
    <ul style="list-style-type:none">
        @foreach (var orderItem in CartActions.listItems)
        {
            <li>
                @orderItem.Quantity
                @orderItem.MenuItem.Name
                @orderItem.UnitPrice.ToString("c")
            </li>
        }
        <li>Subtotal: @CartActions.listItems.Sum(oi => oi.UnitPrice * oi.Quantity).ToString("c")</li>
        <li>Taxes: @CartActions.listItems.Sum(oi => oi.UnitPrice * oi.Quantity * 0.15).ToString("c")</li>
        <li>Taxes: @CartActions.listItems.Sum(oi => oi.UnitPrice * oi.Quantity * 1.15).ToString("c")</li>
    </ul>
</div>
<hr />
<div>
    <h3>Billing information</h3>
</div>
<hr />

@using (Html.BeginForm("Checkout", "Home", FormMethod.Get))
{
    <div class="row">
        <div class="col-md-4">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            @if (!SignInManager.IsSignedIn(User))
            {
                <div class="form-group">
                    <label asp-for="FirstName" class="control-label"></label>
                    <input asp-for="FirstName" class="form-control" value="" />
                    <span asp-validation-for="FirstName" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="LastName" class="control-label"></label>
                    <input asp-for="LastName" class="form-control" />
                    <span asp-validation-for="LastName" class="text-danger"></span>
                </div>
            }
            <div class="form-group">
                <label asp-for="Address" class="control-label"></label>
                @if (!SignInManager.IsSignedIn(User))
                {<input asp-for="Address" class="form-control" /> }
                else
                { <input asp-for="Address" class="form-control" value="@UserManager.GetUserAsync(User).Result.Address" />}
                <span asp-validation-for="Address" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="PostalCode" class="control-label"></label>
                @if (!SignInManager.IsSignedIn(User))
                {<input asp-for="PostalCode" class="form-control" /> }
                else
                { <input asp-for="PostalCode" class="form-control" value="@UserManager.GetUserAsync(User).Result.PostalCode" />}
                <span asp-validation-for="PostalCode" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Email" class="control-label"></label>
                @if (!SignInManager.IsSignedIn(User))
                {<input asp-for="Email" class="form-control" /> }
                else
                { <input asp-for="Email" class="form-control" value="@UserManager.GetUserAsync(User).Result.Email" />}
                <span asp-validation-for="Email" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Phone" class="control-label"></label>
                @if (!SignInManager.IsSignedIn(User))
                {<input asp-for="Phone" class="form-control" /> }
                else
                { <input asp-for="Phone" class="form-control" value="@UserManager.GetUserAsync(User).Result.PhoneNumber" />}
                <span asp-validation-for="Phone" class="text-danger"></span>
            </div>

            <div>
                <p class="control-label">Method of Payment</p>

                <label>
                    <input type="radio" name="type" class="form-control" id="creditCard" onclick="checkMethodPayment()" checked> Credit Card
                </label>

                <label>
                    <input type="radio" name="type" class="form-control" id="cash" onclick="checkMethodPayment()">  Cash
                </label>

                <span class="text-danger"></span>
            </div>
            <div id="creditCardInfo">
                <div class="form-group">
                    <label asp-for="CreditNumber" class="control-label"></label>
                    <input asp-for="CreditNumber" class="form-control" />
                    <span asp-validation-for="CreditNumber" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="Month" class="control-label"></label>
                    <input asp-for="Month" class="form-control" />
                    <span asp-validation-for="Month" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="Year" class="control-label"></label>
                    <input asp-for="Year" class="form-control" />
                    <span asp-validation-for="Year" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="SecurityCode" class="control-label"></label>
                    <input asp-for="SecurityCode" class="form-control" />
                    <span asp-validation-for="SecurityCode" class="text-danger"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="form-group">
        <button class="btn btn-primary" type="submit">Place your order</button>
    </div>
}



@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
<style>
</style>

<script>
    function checkMethodPayment() {
        var creditCardInfo = document.getElementById("creditCardInfo");

        var cash = document.getElementById("cash");

        creditCardInfo.style.display = cash.checked ? "none" : "block";
    }

</script>
